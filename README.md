# AITop - 智能系统监控工具

AITop是一个智能系统监控工具，结合了传统`top`命令的实时性和AI分析的智能性。它提供类似top的命令行界面来实时监控系统进程，并在收集一段时间数据后生成智能化的HTML5分析报告。

## 功能特性

- **实时进程监控**：类似top命令的界面，实时显示系统前20个进程的CPU、内存占用情况
- **定时刷新**：每秒更新一次进程信息，提供流畅的实时体验
- **数据收集**：在后台持续收集系统资源使用情况和系统日志
- **AI智能分析**：收集一段时间（如2分钟）后，AI分析系统性能和日志模式
- **现代化报告**：生成包含分析结果和建议的HTML5网页报告
- **交互式图表**：使用Chart.js生成实时性能趋势图表
- **系统健康评分**：基于CPU、内存使用情况计算系统健康评分
- **命令行参数支持**：丰富的命令行选项，满足不同使用场景

## 安装要求

- Python 3.8+
- psutil 库

```bash
pip install psutil
```

## 使用方法

### 基本使用

```bash
# 基本使用 - 显示实时进程信息，2分钟后生成报告
python src/main.py

# 仅生成报告模式 - 不显示实时界面
python src/main.py --report-only

# 指定数据收集时长（秒）
python src/main.py --duration 300

# 指定界面刷新间隔（秒）
python src/main.py --refresh 2

# 显示更多进程
python src/main.py --top 50

# 指定报告输出路径
python src/main.py --output /path/to/report.html

# 连续模式 - 生成报告后继续监控
python src/main.py --continuous
```

### 命令行参数

| 参数 | 简写 | 默认值 | 描述 |
|------|------|--------|------|
| `--refresh` | `-r` | 1 | 界面刷新间隔（秒） |
| `--top` | `-t` | 20 | 显示的进程数量 |
| `--duration` | `-d` | 120 | 数据收集时长（秒） |
| `--output` | `-o` | `./reports/aitop_report.html` | 报告输出路径 |
| `--auto-report` | | True | 收集完成后自动生成报告 |
| `--no-auto-report` | | | 不自动生成报告 |
| `--continuous` | | | 连续模式，生成报告后继续监控 |
| `--report-only` | | | 仅生成报告，不显示实时界面 |

## 界面展示

### 实时监控界面

```
================================================================================
AITop - 智能系统监控 v1.0.0                    更新时间: 14:30:25
================================================================================
系统概览: CPU: 45.2% | 内存: 67.8% | 负载: 2.34 | 运行时间: 2天3小时

PID      进程名称              CPU%     内存%    内存使用    状态      用户
--------------------------------------------------------------------------------
1234     chrome               15.2     8.4      2.1GB      运行      user
5678     python               12.8     4.2      1.2GB      运行      user
9012     node                 8.9      3.1      890MB      运行      user
3456     firefox              6.7      5.8      1.8GB      运行      user
7890     vscode               4.2      2.9      780MB      运行      user
...
================================================================================
数据收集中... (已收集 45秒/120秒) [███████████░░░░░░░░░░░░░░░░░░░] 37.5%
按 'q' 退出 | 按 'r' 生成报告
```

### HTML报告

生成的HTML报告包含以下内容：

1. **系统健康状况**：健康评分和状态概览
2. **性能指标**：CPU和内存的平均值、峰值统计
3. **性能趋势**：交互式图表显示CPU和内存使用率变化
4. **进程分析**：详细的进程资源占用表格
5. **AI建议**：基于分析结果的系统优化建议
6. **异常检测**：识别的性能异常和警告

## 项目结构

```
src/
├── aitop/                 # 主程序包
│   ├── __init__.py       # 包初始化和主入口
│   └── cli.py            # 命令行界面实现
├── analyzer/             # AI分析模块
│   ├── __init__.py
│   └── system_analyzer.py
├── collector/            # 数据收集模块
│   ├── __init__.py
│   ├── system_collector.py
│   └── log_collector.py
├── reporter/             # 报告生成模块
│   ├── __init__.py
│   └── html_generator.py
├── web/                  # Web服务模块（预留）
└── main.py               # 程序入口点
```

## 技术实现

### 核心技术栈

- **后端**：Python 3.8+
- **系统监控**：psutil库
- **数据分析**：内置统计分析算法
- **前端**：HTML5 + CSS3 + JavaScript
- **图表**：Chart.js
- **模板**：内置HTML模板生成

### 关键功能实现

1. **实时监控**：使用psutil库获取系统和进程信息
2. **数据收集**：时间序列数据存储和管理
3. **AI分析**：基于统计学的异常检测和趋势分析
4. **报告生成**：动态HTML生成和数据可视化
5. **用户交互**：命令行界面和参数处理

## 系统健康评分算法

系统健康评分基于以下指标计算：

- **CPU使用率**：平均CPU使用率 > 80% 扣20分，> 95% 扣30分
- **内存使用率**：平均内存使用率 > 80% 扣20分，> 95% 扣30分
- **峰值影响**：CPU或内存峰值 > 95% 各扣10分

评分范围：0-100分
- 80-100分：良好（绿色）
- 60-79分：一般（黄色）
- 0-59分：需要关注（红色）

## 开发和贡献

### 开发环境设置

```bash
# 克隆项目
git clone <repository-url>
cd aitop

# 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Linux/Mac
# 或 venv\Scripts\activate  # Windows

# 安装依赖
pip install -r requirements.txt
```

### 运行测试

```bash
# 运行演示
python demo.py

# 测试基本功能
python src/main.py --report-only --duration 10
```

## 许可证

MIT License

## 作者

AITop Team

---

**注意**：这是一个演示项目，展示了如何结合传统系统监控工具和现代AI分析技术。在生产环境中使用前，请根据实际需求进行相应的安全性和性能优化。
